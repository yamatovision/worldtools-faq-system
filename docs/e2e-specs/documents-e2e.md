# ナレッジ管理画面 E2Eテスト仕様書

生成日: 2026-02-06
対象ページ: `/admin/documents`
権限レベル: admin

---

## ユーザーゴール

1. ドキュメント一覧を確認する
2. 新規ドキュメントをアップロードする
3. ドキュメントの詳細（チャンク一覧）を確認する
4. ドキュメントの公開範囲を設定する
5. ドキュメントを削除する

---

## テスト環境

```yaml
URL: http://localhost:3247/admin/documents
認証: 必須（ProtectedRoute + admin権限）
テストアカウント:
  email: admin@example.com
  password: admin123
対応ファイル: PDF, Word (.docx), Excel (.xlsx), テキスト (.txt)
```

---

## E2Eテスト項目一覧（8項目）

| ID | テスト項目 | フロー内容 | 期待結果 |
|----|----------|-----------|---------|
| E2E-DOC-001 | ページ表示・一覧確認 | 管理者ログイン → /admin/documents → テーブル表示 | ドキュメント一覧（ファイル名、形式、公開範囲、チャンク数、グラフステータス、登録日）が表示される |
| E2E-DOC-002 | ドラッグ&ドロップアップロード | PDFファイルをドラッグ&ドロップエリアにドロップ → アップロード完了 | 「アップロード中...」表示 → 成功スナックバー → 一覧に新ファイルが追加される |
| E2E-DOC-003 | ボタンからアップロード | 「ファイルをアップロード」ボタン → ファイル選択 → アップロード完了 | ファイル選択ダイアログ → アップロード成功 → 一覧に反映 |
| E2E-DOC-004 | ファイル形式エラー | 非対応形式（例: .mp4）をアップロード | 「対応していないファイル形式です（PDF, Word, Excel, TXTのみ）」エラー表示 |
| E2E-DOC-005 | ドキュメント詳細表示フロー | テーブル行クリック → 詳細ダイアログ表示 | ファイル名、形式、公開範囲、全チャンクの内容が表示される |
| E2E-DOC-006 | 権限設定フロー | 権限設定ボタン → ダイアログ表示 → 全社公開OFF → 部門選択 → 保存 | 権限設定ダイアログ表示 → 部門選択UI表示 → 保存成功 → テーブルに部門名が反映 |
| E2E-DOC-007 | ドキュメント削除フロー | 削除ボタン → 確認ダイアログ → OK | 「このドキュメントを削除してもよろしいですか？」確認 → 削除成功 → 一覧から消える |
| E2E-DOC-008 | 検索機能 | 検索ボックスにキーワード入力 → 結果絞り込み | 入力キーワードがファイル名に含まれるドキュメントのみ表示される |

---

## 備考

- BOX連携機能は「正式版で対応予定」としてモックダイアログのみ（E2Eテストから除外）
- グラフビルドステータスは4種（pending/building/completed/failed）
- 検索はファイル名のみ（大文字小文字区別なし）
