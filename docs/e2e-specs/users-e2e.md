# ユーザー管理画面 E2Eテスト仕様書

生成日: 2026-02-06
対象ページ: `/admin/users`
権限レベル: admin

---

## ユーザーゴール

1. ユーザー一覧を確認する
2. 新規ユーザーを追加する
3. 既存ユーザーを編集する（パスワード変更含む）
4. ユーザーを削除する（自分自身は削除不可）

---

## テスト環境

```yaml
URL: http://localhost:3247/admin/users
認証: 必須（ProtectedRoute + admin権限）
テストアカウント:
  email: admin@example.com
  password: admin123
```

---

## E2Eテスト項目一覧（8項目）

| ID | テスト項目 | フロー内容 | 期待結果 |
|----|----------|-----------|---------|
| E2E-USER-001 | ページ表示・一覧確認 | 管理者ログイン → /admin/users → テーブル表示 | ユーザー一覧（名前、メール、部門、権限、状態）が表示される |
| E2E-USER-002 | ユーザー追加フロー | 「ユーザーを追加」ボタン → ダイアログ → 名前・メール・パスワード・部門・権限入力 → 「作成」 | ダイアログ表示 → 保存成功 → 一覧に新ユーザーが追加される |
| E2E-USER-003 | ユーザー編集フロー | 編集ボタン → ダイアログ → 名前変更 → 「更新」 | ダイアログに既存データが入力済み → 更新成功 → 一覧に変更が反映される |
| E2E-USER-004 | パスワード変更フロー | 編集ダイアログ → パスワード欄に新パスワード入力 → 「更新」 | パスワード欄に「パスワード（変更する場合のみ）」ラベル表示 → 更新成功スナックバー |
| E2E-USER-005 | アカウント無効化フロー | 編集ダイアログ → 「アカウント有効」スイッチOFF → 「更新」 | スイッチが表示（新規作成時は非表示） → 更新成功 → テーブルで「無効」チップ表示 |
| E2E-USER-006 | ユーザー削除フロー（成功） | 他ユーザーの削除ボタン → 確認 → OK | 確認ダイアログ表示 → 削除成功 → 一覧から消える |
| E2E-USER-007 | 自分自身の削除制限 | ログイン中ユーザーの削除ボタンクリック | 「自分自身は削除できません」エラースナックバー表示 |
| E2E-USER-008 | 入力バリデーション | 新規作成ダイアログで名前・メール・パスワードを空にして「作成」 | 「作成」ボタンが無効化されている（name・email・passwordは必須） |

---

## 備考

- 新規作成時は`password`必須だが、編集時は任意（変更する場合のみ入力）
- 自分自身の削除ボタンは無効化されている（`disabled={user.id === currentUser?.id}`）
- 部門は任意選択（「なし」も選択可能）
- 権限は「ユーザー」「管理者」の2種類
