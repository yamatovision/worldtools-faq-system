# 部門管理画面 E2Eテスト仕様書

生成日: 2026-02-06
対象ページ: `/admin/departments`
権限レベル: admin

---

## ユーザーゴール

1. 部門一覧を確認する
2. 新規部門を追加する
3. 既存部門を編集する
4. 部門を削除する（ユーザーが所属していない場合のみ）

---

## テスト環境

```yaml
URL: http://localhost:3247/admin/departments
認証: 必須（ProtectedRoute + admin権限）
テストアカウント:
  email: admin@example.com
  password: admin123
```

---

## E2Eテスト項目一覧（6項目）

| ID | テスト項目 | フロー内容 | 期待結果 |
|----|----------|-----------|---------|
| E2E-DEPT-001 | ページ表示・一覧確認 | 管理者ログイン → /admin/departments → テーブル表示 | 部門一覧（部門名、説明、ユーザー数、ドキュメント数）が表示される |
| E2E-DEPT-002 | 部門追加フロー | 「部門を追加」ボタン → ダイアログ → 部門名・説明入力 → 「作成」 | ダイアログ表示 → 保存成功スナックバー → 一覧に新部門が追加される |
| E2E-DEPT-003 | 部門編集フロー | 編集ボタン → ダイアログ → 部門名変更 → 「更新」 | ダイアログに既存データが入力済み → 更新成功 → 一覧に変更が反映される |
| E2E-DEPT-004 | 部門削除フロー（成功） | ユーザー数0の部門の削除ボタン → 確認 → OK | 確認ダイアログ表示 → 削除成功 → 一覧から消える |
| E2E-DEPT-005 | 部門削除の制限（ユーザー所属時） | ユーザー数1以上の部門の削除ボタンクリック | 「ユーザーが所属している部門は削除できません」エラースナックバー表示 |
| E2E-DEPT-006 | 入力バリデーション | ダイアログで部門名を空にして「作成」ボタン | 「作成」ボタンが無効化されている（クリックできない） |

---

## 備考

- 部門削除は`userCount > 0`の場合は実行不可（削除ボタンは表示されるが、クリック時にエラー）
- 説明は任意項目（空でも保存可能）
- テーブルの「ユーザー数」「ドキュメント数」は集計値を表示
